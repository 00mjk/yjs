!function t(e,n,r){function i(u,s){if(!n[u]){if(!e[u]){var l="function"==typeof require&&require;if(!s&&l)return l(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module '"+u+"'")}var p=n[u]={exports:{}};e[u][0].call(p.exports,function(t){var n=e[u][1][t];return i(n?n:t)},p,p.exports,t,e,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,e){var n;n=function(t,e,n,r){var i,o,u,s,l,p;return p=function(e){return e.uid.creator===n.getUserId()&&"string"!=typeof e.uid.op_number?t.broadcast(e):void 0},null!=t.invokeSync&&n.setInvokeSyncHandler(t.invokeSync),r.push(p),o=function(t){var e,n,r;r=[];for(e in t)n=t[e],r.push({user:e,state:n});return r},u=function(t){var e,n,r,i;for(n={},r=0,i=t.length;i>r;r++)e=t[r],n[e.user]=e.state;return n},l=function(){return o(n.getOperationCounter())},s=function(t){var e,r;return r=u(t),e={hb:n._encode(r),state_vector:o(n.getOperationCounter())}},i=function(t){return n.renewStateVector(u(t.state_vector)),e.applyOpsCheckDouble(t.hb)},t.whenSyncing(l,s,i),t.whenReceiving(function(t,r){return r.uid.creator!==n.getUserId()?e.applyOp(r):void 0}),null!=t._whenBoundToYatta?t._whenBoundToYatta():void 0},e.exports=n},{}],2:[function(t,e){var n;"undefined"!=typeof window&&null!==window&&(window.unprocessed_counter=0),"undefined"!=typeof window&&null!==window&&(window.unprocessed_exec_counter=0),"undefined"!=typeof window&&null!==window&&(window.unprocessed_types=[]),n=function(){function t(t,e){this.HB=t,this.parser=e,this.unprocessed_ops=[]}return t.prototype.parseOperation=function(t){var e;if(e=this.parser[t.type],null!=e)return e(t);throw new Error("You forgot to specify a parser for type "+t.type+". The message is "+JSON.stringify(t)+".")},t.prototype.applyOpsCheckDouble=function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],null==this.HB.getOperation(e.uid)?i.push(this.applyOp(e)):i.push(void 0);return i},t.prototype.applyOps=function(t){return this.applyOp(t)},t.prototype.applyOp=function(t){var e,n,r,i;for(t.constructor!==Array&&(t=[t]),r=0,i=t.length;i>r;r++)n=t[r],e=this.parseOperation(n),null!=this.HB.getOperation(e)||this.HB.isExpectedOperation(e)&&e.execute()||(this.unprocessed_ops.push(e),"undefined"!=typeof window&&null!==window&&window.unprocessed_types.push(e.type));return this.tryUnprocessed()},t.prototype.tryUnprocessed=function(){for(var t,e,n,r,i,o;;){for(t=this.unprocessed_ops.length,n=[],o=this.unprocessed_ops,r=0,i=o.length;i>r;r++)e=o[r],null!=this.HB.getOperation(e)||this.HB.isExpectedOperation(e)&&e.execute()||n.push(e);if(this.unprocessed_ops=n,this.unprocessed_ops.length===t)break}return 0!==this.unprocessed_ops.length?this.HB.invokeSync():void 0},t}(),e.exports=n},{}],3:[function(t,e){var n,r=function(t,e){return function(){return t.apply(e,arguments)}};n=function(){function t(t){this.user_id=t,this.emptyGarbage=r(this.emptyGarbage,this),this.operation_counter={},this.buffer={},this.change_listeners=[],this.garbage=[],this.trash=[],this.performGarbageCollection=!0,this.garbageCollectTimeout=2e4,this.reserved_identifier_counter=0,setTimeout(this.emptyGarbage,this.garbageCollectTimeout)}return t.prototype.resetUserId=function(t){var e,n,r;if(r=this.buffer[this.user_id],null!=r){for(n in r)e=r[n],e.uid.creator=t;if(null!=this.buffer[t])throw new Error("You are re-assigning an old user id - this is not (yet) possible!");this.buffer[t]=r,delete this.buffer[this.user_id]}return this.operation_counter[t]=this.operation_counter[this.user_id],delete this.operation_counter[this.user_id],this.user_id=t},t.prototype.emptyGarbage=function(){var t,e,n,r;for(r=this.garbage,e=0,n=r.length;n>e;e++)t=r[e],"function"==typeof t.cleanup&&t.cleanup();return this.garbage=this.trash,this.trash=[],-1!==this.garbageCollectTimeout&&(this.garbageCollectTimeoutId=setTimeout(this.emptyGarbage,this.garbageCollectTimeout)),void 0},t.prototype.getUserId=function(){return this.user_id},t.prototype.addToGarbageCollector=function(){var t,e,n,r;if(this.performGarbageCollection){for(r=[],e=0,n=arguments.length;n>e;e++)t=arguments[e],null!=t?r.push(this.garbage.push(t)):r.push(void 0);return r}},t.prototype.stopGarbageCollection=function(){return this.performGarbageCollection=!1,this.setManualGarbageCollect(),this.garbage=[],this.trash=[]},t.prototype.setManualGarbageCollect=function(){return this.garbageCollectTimeout=-1,clearTimeout(this.garbageCollectTimeoutId),this.garbageCollectTimeoutId=void 0},t.prototype.setGarbageCollectTimeout=function(t){this.garbageCollectTimeout=t},t.prototype.getReservedUniqueIdentifier=function(){return{creator:"_",op_number:"_"+this.reserved_identifier_counter++,doSync:!1}},t.prototype.getOperationCounter=function(t){var e,n,r,i;if(null==t){n={},i=this.operation_counter;for(r in i)e=i[r],n[r]=e;return n}return this.operation_counter[t]},t.prototype.isExpectedOperation=function(t){var e,n;return null==(e=this.operation_counter)[n=t.uid.creator]&&(e[n]=0),t.uid.op_number<=this.operation_counter[t.uid.creator]},t.prototype._encode=function(t){var e,n,r,i,o,u,s,l,p,a;null==t&&(t={}),e=[],l=function(e,n){if(null==e||null==n)throw new Error("dah!");return null==t[e]||t[e]<=n},a=this.buffer;for(s in a){p=a[s];for(o in p)if(n=p[o],n.uid.doSync&&l(s,o)){if(r=n._encode(),null!=n.next_cl){for(i=n.next_cl;null!=i.next_cl&&l(i.uid.creator,i.uid.op_number);)i=i.next_cl;r.next=i.getUid()}else if(null!=n.prev_cl){for(u=n.prev_cl;null!=u.prev_cl&&l(u.uid.creator,u.uid.op_number);)u=u.prev_cl;r.prev=u.getUid()}e.push(r)}}return e},t.prototype.getNextOperationIdentifier=function(t){var e;return null==t&&(t=this.user_id),null==this.operation_counter[t]&&(this.operation_counter[t]=0),e={creator:t,op_number:this.operation_counter[t],doSync:!0},this.operation_counter[t]++,e},t.prototype.getOperation=function(t){var e,n;return null!=t.uid&&(t=t.uid),e=null!=(n=this.buffer[t.creator])?n[t.op_number]:void 0,null!=t.sub&&null!=e?e.retrieveSub(t.sub):e},t.prototype.addOperation=function(t){if(null==this.buffer[t.uid.creator]&&(this.buffer[t.uid.creator]={}),null!=this.buffer[t.uid.creator][t.uid.op_number])throw new Error("You must not overwrite operations!");if(t.uid.op_number.constructor!==String&&!this.isExpectedOperation(t))throw new Error("this operation was not expected!");return this.addToCounter(t),this.buffer[t.uid.creator][t.uid.op_number]=t,t},t.prototype.removeOperation=function(t){var e;return null!=(e=this.buffer[t.uid.creator])?delete e[t.uid.op_number]:void 0},t.prototype.setInvokeSyncHandler=function(t){return this.invokeSync=t},t.prototype.invokeSync=function(){},t.prototype.renewStateVector=function(t){var e,n,r;r=[];for(n in t)e=t[n],null==this.operation_counter[n]||this.operation_counter[n]<t[n]?r.push(this.operation_counter[n]=t[n]):r.push(void 0);return r},t.prototype.addToCounter=function(t){return null==this.operation_counter[t.uid.creator]&&(this.operation_counter[t.uid.creator]=0),"number"==typeof t.uid.op_number&&t.uid.creator!==this.getUserId()?t.uid.op_number===this.operation_counter[t.uid.creator]?this.operation_counter[t.uid.creator]++:this.invokeSync(t.uid.creator):void 0},t}(),e.exports=n},{}],4:[function(t,e){var n=[].slice,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};e.exports=function(t){var e,r,o,u,s,l,p;return p={},l=[],s=function(){function e(t){this.is_deleted=!1,this.garbage_collected=!1,this.event_listeners=[],null!=t&&(this.uid=t)}return e.prototype.type="Operation",e.prototype.retrieveSub=function(){throw new Error("sub properties are not enable on this operation type!")},e.prototype.observe=function(t){return this.event_listeners.push(t)},e.prototype.unobserve=function(t){return this.event_listeners=this.event_listeners.filter(function(e){return t!==e})},e.prototype.deleteAllObservers=function(){return this.event_listeners=[]},e.prototype.callEvent=function(){return this.forwardEvent.apply(this,[this].concat(n.call(arguments)))},e.prototype.forwardEvent=function(){var t,e,r,i,o,u,s;for(r=arguments[0],t=2<=arguments.length?n.call(arguments,1):[],u=this.event_listeners,s=[],i=0,o=u.length;o>i;i++)e=u[i],s.push(e.call.apply(e,[r].concat(n.call(t))));return s},e.prototype.isDeleted=function(){return this.is_deleted},e.prototype.applyDelete=function(e){return null==e&&(e=!0),!this.garbage_collected&&(this.is_deleted=!0,e)?(this.garbage_collected=!0,t.addToGarbageCollector(this)):void 0},e.prototype.cleanup=function(){return t.removeOperation(this),this.deleteAllObservers()},e.prototype.setParent=function(t){this.parent=t},e.prototype.getParent=function(){return this.parent},e.prototype.getUid=function(){return null==this.uid.noOperation?this.uid:this.uid.alt},e.prototype.cloneUid=function(){var t,e,n,r;e={},r=this.getUid();for(t in r)n=r[t],e[t]=n;return e},e.prototype.dontSync=function(){return this.uid.doSync=!1},e.prototype.execute=function(){var e,n,r;if(this.is_executed=!0,null==this.uid&&(this.uid=t.getNextOperationIdentifier()),null==this.uid.noOperation)for(t.addOperation(this),n=0,r=l.length;r>n;n++)e=l[n],e(this._encode());return this},e.prototype.saveOperation=function(t,e){return null!=(null!=e?e.execute:void 0)?this[t]=e:null!=e?(null==this.unchecked&&(this.unchecked={}),this.unchecked[t]=e):void 0},e.prototype.validateSavedOperations=function(){var e,n,r,i,o,u;o={},i=this,u=this.unchecked;for(e in u)r=u[e],n=t.getOperation(r),n?this[e]=n:(o[e]=r,i=!1);return delete this.unchecked,i||(this.unchecked=o),i},e}(),e=function(t){function e(t,n){this.saveOperation("deletes",n),e.__super__.constructor.call(this,t)}return i(e,t),e.prototype.type="Delete",e.prototype._encode=function(){return{type:"Delete",uid:this.getUid(),deletes:this.deletes.getUid()}},e.prototype.execute=function(){var t;return this.validateSavedOperations()?(t=e.__super__.execute.apply(this,arguments),t&&this.deletes.applyDelete(this),t):!1},e}(s),p.Delete=function(t){var n,r;return r=t.uid,n=t.deletes,new e(r,n)},u=function(t){function e(t,n,r,i,o){this.saveOperation("parent",o),this.saveOperation("prev_cl",n),this.saveOperation("next_cl",r),null!=i?this.saveOperation("origin",i):this.saveOperation("origin",n),e.__super__.constructor.call(this,t)}return i(e,t),e.prototype.type="Insert",e.prototype.applyDelete=function(t){var n,r,i;return null==this.deleted_by&&(this.deleted_by=[]),n=!1,null==this.parent||this.isDeleted()||null==t||(n=!0),null!=t&&this.deleted_by.push(t),r=!1,this.next_cl.isDeleted()&&(r=!0),e.__super__.applyDelete.call(this,r),n&&this.callOperationSpecificDeleteEvents(t),(null!=(i=this.prev_cl)?i.isDeleted():void 0)?this.prev_cl.applyDelete():void 0},e.prototype.cleanup=function(){var t,n,r,i,o;if(this.next_cl.isDeleted()){for(o=this.deleted_by,r=0,i=o.length;i>r;r++)t=o[r],t.cleanup();for(n=this.next_cl;"Delimiter"!==n.type;)n.origin===this&&(n.origin=this.prev_cl),n=n.next_cl;return this.prev_cl.next_cl=this.next_cl,this.next_cl.prev_cl=this.prev_cl,e.__super__.cleanup.apply(this,arguments)}},e.prototype.getDistanceToOrigin=function(){var t,e;for(t=0,e=this.prev_cl;;){if(this.origin===e)break;t++,e=e.prev_cl}return t},e.prototype.execute=function(){var t,n,r;if(this.validateSavedOperations()){if(null!=this.parent&&(null==this.prev_cl&&(this.prev_cl=this.parent.beginning),null==this.origin&&(this.origin=this.parent.beginning),null==this.next_cl&&(this.next_cl=this.parent.end)),null!=this.prev_cl){for(t=this.getDistanceToOrigin(),r=this.prev_cl.next_cl,n=t;;){if(r===this.next_cl)break;if(r.getDistanceToOrigin()===n)r.uid.creator<this.uid.creator&&(this.prev_cl=r,t=n+1);else{if(!(r.getDistanceToOrigin()<n))break;n-t<=r.getDistanceToOrigin()&&(this.prev_cl=r,t=n+1)}n++,r=r.next_cl}this.next_cl=this.prev_cl.next_cl,this.prev_cl.next_cl=this,this.next_cl.prev_cl=this}return this.setParent(this.prev_cl.getParent()),e.__super__.execute.apply(this,arguments),this.callOperationSpecificInsertEvents(),this}return!1},e.prototype.callOperationSpecificInsertEvents=function(){var t;return null!=(t=this.parent)?t.callEvent([{type:"insert",position:this.getPosition(),object:this.parent,changedBy:this.uid.creator,value:this.content}]):void 0},e.prototype.callOperationSpecificDeleteEvents=function(t){return this.parent.callEvent([{type:"delete",position:this.getPosition(),object:this.parent,length:1,changedBy:t.uid.creator}])},e.prototype.getPosition=function(){var t,e;for(t=0,e=this.prev_cl;;){if(e instanceof r)break;e.isDeleted()||t++,e=e.prev_cl}return t},e}(s),o=function(t){function e(t,n){this.content=n,e.__super__.constructor.call(this,t)}return i(e,t),e.prototype.type="ImmutableObject",e.prototype.val=function(){return this.content},e.prototype._encode=function(){var t;return t={type:"ImmutableObject",uid:this.getUid(),content:this.content}},e}(s),p.ImmutableObject=function(t){var e,n;return n=t.uid,e=t.content,new o(n,e)},r=function(t){function e(t,n){this.saveOperation("prev_cl",t),this.saveOperation("next_cl",n),this.saveOperation("origin",t),e.__super__.constructor.call(this,{noOperation:!0})}return i(e,t),e.prototype.type="Delimiter",e.prototype.applyDelete=function(){var t;for(e.__super__.applyDelete.call(this),t=this.prev_cl;null!=t;)t.applyDelete(),t=t.prev_cl;return void 0},e.prototype.cleanup=function(){return e.__super__.cleanup.call(this)},e.prototype.execute=function(){var t,n;if(null!=(null!=(t=this.unchecked)?t.next_cl:void 0))return e.__super__.execute.apply(this,arguments);if(null!=(n=this.unchecked)?n.prev_cl:void 0){if(this.validateSavedOperations()){if(null!=this.prev_cl.next_cl)throw new Error("Probably duplicated operations");return this.prev_cl.next_cl=this,e.__super__.execute.apply(this,arguments)}return!1}return null!=this.prev_cl&&null==this.prev_cl.next_cl?(delete this.prev_cl.unchecked.next_cl,this.prev_cl.next_cl=this,e.__super__.execute.apply(this,arguments)):e.__super__.execute.apply(this,arguments)},e.prototype._encode=function(){var t,e;return{type:"Delimiter",uid:this.getUid(),prev:null!=(t=this.prev_cl)?t.getUid():void 0,next:null!=(e=this.next_cl)?e.getUid():void 0}},e}(s),p.Delimiter=function(t){var e,n,i;return i=t.uid,n=t.prev,e=t.next,new r(i,n,e)},{types:{Delete:e,Insert:u,Delimiter:r,Operation:s,ImmutableObject:o},parser:p,execution_listener:l}}},{}],5:[function(t,e){var n,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./TextTypes"),e.exports=function(t){var e,r,o,u,s;return u=n(t),s=u.types,o=u.parser,r=function(t){var n;return n=function(){function t(n){var i,o,u,l;l=n.map,u=function(i,o){return Object.defineProperty(t.prototype,i,{get:function(){var t;return t=o.val(),t instanceof e?r(t):t instanceof s.ImmutableObject?t.val():t},set:function(t){var e,r,o,u;if(o=n.val(i),t.constructor==={}.constructor&&o instanceof s.Operation){u=[];for(e in t)r=t[e],u.push(o.val(e,r,"immutable"));return u}return n.val(i,t,"immutable")},enumerable:!0,configurable:!1})};for(i in l)o=l[i],u(i,o)}return t}(),new n(t)},e=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.type="JsonType",n.prototype.applyDelete=function(){return n.__super__.applyDelete.call(this)},n.prototype.cleanup=function(){return n.__super__.cleanup.call(this)},n.prototype.toJson=function(e){var r,i,o,u,l;null==e&&(e=!1),l=this.val(),r={};for(i in l)o=l[i],r[i]=o instanceof n?o.toJson(e):e&&o instanceof s.Operation?o.val():o;return this.bound_json=r,null!=Object.observe&&(u=this,Object.observe(this.bound_json,function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],null!=e.changedBy||"add"!==e.type&&!(e.type="update")?i.push(void 0):i.push(u.val(e.name,e.object[e.name]));return i}),this.observe(function(e){var n,r,i,o,s,l;for(l=[],o=0,s=e.length;s>o;o++)n=e[o],n.created_!==t.getUserId()?(r=Object.getNotifier(u.bound_json),i=u.bound_json[n.name],null!=i?(r.performChange("update",function(){return u.bound_json[n.name]=u.val(n.name)},u.bound_json),l.push(r.notify({object:u.bound_json,type:"update",name:n.name,oldValue:i,changedBy:n.changedBy}))):(r.performChange("add",function(){return u.bound_json[n.name]=u.val(n.name)},u.bound_json),l.push(r.notify({object:u.bound_json,type:"add",name:n.name,oldValue:i,changedBy:n.changedBy})))):l.push(void 0);return l})),this.bound_json},n.prototype.mutable_default=!1,n.prototype.setMutableDefault=function(t){if(t===!0||"mutable"===t)n.prototype.mutable_default=!0;else{if(t!==!1&&"immutable"!==t)throw new Error('Set mutable either "mutable" or "immutable"!');n.prototype.mutable_default=!1}return"OK"},n.prototype.val=function(t,e,r){var i,o,u,l;if(null!=t&&arguments.length>1){if(r=null!=r?r===!0||"mutable"===r?!0:!1:this.mutable_default,"function"==typeof e)return this;if(null!=e&&(r&&"number"!=typeof e||e.constructor===Object)){if("string"==typeof e)return l=new s.WordType(void 0).execute(),l.insertText(0,e),n.__super__.val.call(this,t,l);if(e.constructor===Object){i=(new n).execute();for(o in e)u=e[o],i.val(o,u,r);return n.__super__.val.call(this,t,i)}throw new Error("You must not set "+typeof e+"-types in collaborative Json-objects!")}return n.__super__.val.call(this,t,new s.ImmutableObject(void 0,e).execute())}return n.__super__.val.call(this,t,e)},Object.defineProperty(n.prototype,"value",{get:function(){return r(this)},set:function(t){var e,n,r;if(t.constructor==={}.constructor){r=[];for(e in t)n=t[e],r.push(this.val(e,n,"immutable"));return r}throw new Error("You must only set Object values!")}}),n.prototype._encode=function(){return{type:"JsonType",uid:this.getUid()}},n}(s.MapManager),o.JsonType=function(t){var n;return n=t.uid,new e(n)},s.JsonType=e,u}},{"./TextTypes":7}],6:[function(t,e){var n,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./BasicTypes"),e.exports=function(t){var e,r,o,u,s,l,p;return s=n(t),p=s.types,l=s.parser,r=function(t){function e(t){this.map={},e.__super__.constructor.call(this,t)}return i(e,t),e.prototype.type="MapManager",e.prototype.applyDelete=function(){var t,n,r;r=this.map;for(t in r)n=r[t],n.applyDelete();return e.__super__.applyDelete.call(this)},e.prototype.cleanup=function(){return e.__super__.cleanup.call(this)},e.prototype.val=function(t,e){var n,r,i,o,u;if(null!=e)return this.retrieveSub(t).replace(e),this;if(null!=t)return i=this.map[t],null==i||i.isContentDeleted()?void 0:(r=i.val(),r instanceof p.ImmutableObject?r.val():r);o={},u=this.map;for(t in u)n=u[t],n.isContentDeleted()||(r=n.val(),r instanceof p.ImmutableObject&&(r=r.val()),o[t]=r);return o},e.prototype["delete"]=function(t){var e;return null!=(e=this.map[t])&&e.deleteContent(),this},e.prototype.retrieveSub=function(t){var e,n,r,i,u;return null==this.map[t]&&(e={name:t},n=this,r=this.cloneUid(),r.sub=t,u={noOperation:!0,alt:r},i=new o(e,n,u),this.map[t]=i,i.setParent(this,t),i.execute()),this.map[t]},e}(p.Operation),e=function(t){function e(t){this.beginning=new p.Delimiter(void 0,void 0),this.end=new p.Delimiter(this.beginning,void 0),this.beginning.next_cl=this.end,this.beginning.execute(),this.end.execute(),e.__super__.constructor.call(this,t)}return i(e,t),e.prototype.type="ListManager",e.prototype.execute=function(){return this.validateSavedOperations()?(this.beginning.setParent(this),this.end.setParent(this),e.__super__.execute.apply(this,arguments)):!1},e.prototype.getLastOperation=function(){return this.end.prev_cl},e.prototype.getFirstOperation=function(){return this.beginning.next_cl},e.prototype.toArray=function(){var t,e;for(t=this.beginning.next_cl,e=[];t!==this.end;)e.push(t),t=t.next_cl;return e},e.prototype.getOperationByPosition=function(t){var e;for(e=this.beginning;;){if(e instanceof p.Delimiter&&null!=e.prev_cl){for(e=e.prev_cl;e.isDeleted()||!(e instanceof p.Delimiter);)e=e.prev_cl;break}if(0>=t&&!e.isDeleted())break;e=e.next_cl,e.isDeleted()||(t-=1)}return e},e}(p.Operation),o=function(t){function e(t,n,r,i,o){this.event_properties=t,this.event_this=n,null==this.event_properties.object&&(this.event_properties.object=this.event_this),e.__super__.constructor.call(this,r,i,o)}return i(e,t),e.prototype.type="ReplaceManager",e.prototype.applyDelete=function(){var t;for(t=this.beginning;null!=t;)t.applyDelete(),t=t.next_cl;return e.__super__.applyDelete.call(this)},e.prototype.cleanup=function(){return e.__super__.cleanup.call(this)},e.prototype.callEventDecorator=function(t){var e,n,r,i,o,u;if(!this.isDeleted()){for(i=0,o=t.length;o>i;i++){e=t[i],u=this.event_properties;for(n in u)r=u[n],e[n]=r}this.event_this.callEvent(t)}return void 0},e.prototype.replace=function(t,e){var n,r;return n=this.getLastOperation(),r=new u(t,this,e,n,n.next_cl).execute(),void 0},e.prototype.isContentDeleted=function(){return this.getLastOperation().isDeleted()},e.prototype.deleteContent=function(){return new p.Delete(void 0,this.getLastOperation().uid).execute(),void 0},e.prototype.val=function(){var t;return t=this.getLastOperation(),"function"==typeof t.val?t.val():void 0},e.prototype._encode=function(){var t;return t={type:"ReplaceManager",uid:this.getUid(),beginning:this.beginning.getUid(),end:this.end.getUid()}},e}(e),u=function(t){function e(t,n,r,i,o,u,s){this.saveOperation("content",t),this.saveOperation("parent",n),e.__super__.constructor.call(this,r,i,o,u),this.is_deleted=s}return i(e,t),e.prototype.type="Replaceable",e.prototype.val=function(){return this.content},e.prototype.applyDelete=function(){var t;return t=e.__super__.applyDelete.apply(this,arguments),null!=this.content&&("Delimiter"!==this.next_cl.type&&this.content.deleteAllObservers(),this.content.applyDelete(),this.content.dontSync()),this.content=null,t},e.prototype.cleanup=function(){return e.__super__.cleanup.apply(this,arguments)},e.prototype.callOperationSpecificInsertEvents=function(){var t;return"Delimiter"===this.next_cl.type&&"Delimiter"!==this.prev_cl.type?(this.is_deleted||(t=this.prev_cl.content,this.parent.callEventDecorator([{type:"update",changedBy:this.uid.creator,oldValue:t}])),this.prev_cl.applyDelete()):"Delimiter"!==this.next_cl.type?this.applyDelete():this.parent.callEventDecorator([{type:"add",changedBy:this.uid.creator}]),void 0},e.prototype.callOperationSpecificDeleteEvents=function(t){return"Delimiter"===this.next_cl.type?this.parent.callEventDecorator([{type:"delete",changedBy:t.uid.creator,oldValue:this.content}]):void 0},e.prototype._encode=function(){var t,e;return t={type:"Replaceable",content:null!=(e=this.content)?e.getUid():void 0,parent:this.parent.getUid(),prev:this.prev_cl.getUid(),next:this.next_cl.getUid(),origin:this.origin.getUid(),uid:this.getUid(),is_deleted:this.is_deleted}},e}(p.Insert),l.Replaceable=function(t){var e,n,r,i,o,s,l;return e=t.content,o=t.parent,l=t.uid,s=t.prev,r=t.next,i=t.origin,n=t.is_deleted,new u(e,o,l,s,r,i,n)},p.ListManager=e,p.MapManager=r,p.ReplaceManager=o,p.Replaceable=u,s}},{"./BasicTypes":4}],7:[function(t,e){var n,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./StructuredTypes"),e.exports=function(t){var e,r,o,u,s,l;return s=n(t),l=s.types,u=s.parser,e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e}(l.Delete),u.TextDelete=u.Delete,r=function(t){function e(t,n,r,i,o,u){var s;(null!=t?null!=(s=t.uid)?s.creator:void 0:void 0)?this.saveOperation("content",t):this.content=t,e.__super__.constructor.call(this,n,r,i,o,u)}return i(e,t),e.prototype.type="TextInsert",e.prototype.getLength=function(){return this.isDeleted()?0:this.content.length},e.prototype.applyDelete=function(){return e.__super__.applyDelete.apply(this,arguments),this.content instanceof l.Operation&&this.content.applyDelete(),this.content=null},e.prototype.execute=function(){return this.validateSavedOperations()?(this.content instanceof l.Operation&&(this.content.insert_parent=this),e.__super__.execute.call(this)):!1},e.prototype.val=function(){return this.isDeleted()||null==this.content?"":this.content},e.prototype._encode=function(){var t,e;return t={type:"TextInsert",uid:this.getUid(),prev:this.prev_cl.getUid(),next:this.next_cl.getUid(),origin:this.origin.getUid(),parent:this.parent.getUid()},t.content=null!=(null!=(e=this.content)?e.getUid:void 0)?this.content.getUid():this.content,t},e}(l.Insert),u.TextInsert=function(t){var e,n,i,o,u,s;return e=t.content,s=t.uid,u=t.prev,n=t.next,i=t.origin,o=t.parent,new r(e,s,u,n,i,o)},o=function(t){function n(t){this.textfields=[],n.__super__.constructor.call(this,t)}return i(n,t),n.prototype.type="WordType",n.prototype.applyDelete=function(){var t;for(t=this.end;null!=t;)t.applyDelete(),t=t.prev_cl;return n.__super__.applyDelete.call(this)},n.prototype.cleanup=function(){return n.__super__.cleanup.call(this)},n.prototype.push=function(t){return this.insertAfter(this.end.prev_cl,t)},n.prototype.insertAfter=function(t,e){var n,i,o,u,s;for(i=t.next_cl;i.isDeleted();)i=i.next_cl;if(t=i.prev_cl,null!=e.type)new r(e,void 0,t,i).execute();else for(u=0,s=e.length;s>u;u++)n=e[u],o=new r(n,void 0,t,i).execute(),t=o;return this},n.prototype.insertText=function(t,e){var n;return n=this.getOperationByPosition(t),this.insertAfter(n,e)},n.prototype.deleteText=function(t,n){var r,i,o,u,s;for(u=this.getOperationByPosition(t+1),i=[],o=s=0;(n>=0?n>s:s>n)&&!(u instanceof l.Delimiter);o=n>=0?++s:--s){for(r=new e(void 0,u).execute(),u=u.next_cl;!(u instanceof l.Delimiter)&&u.isDeleted();)u=u.next_cl;i.push(r._encode())}return this},n.prototype.val=function(){var t,e;return t=function(){var t,n,r,i;for(r=this.toArray(),i=[],t=0,n=r.length;n>t;t++)e=r[t],null!=e.val?i.push(e.val()):i.push("");return i}.call(this),t.join("")},n.prototype.toString=function(){return this.val()},n.prototype.bind=function(t){var e;return e=this,t.value=this.val(),this.textfields.push(t),this.observe(function(n){var r,i,o,u,s,l,p,a;for(a=[],l=0,p=n.length;p>l;l++)r=n[l],"insert"===r.type?(u=r.position,i=function(t){return u>=t?t:t+=1},o=i(t.selectionStart),s=i(t.selectionEnd),t.value=e.val(),a.push(t.setSelectionRange(o,s))):"delete"===r.type?(u=r.position,i=function(t){return u>t?t:t-=1},o=i(t.selectionStart),s=i(t.selectionEnd),t.value=e.val(),a.push(t.setSelectionRange(o,s))):a.push(void 0);return a}),t.onkeypress=function(n){var r,i,o,u;return e.is_deleted?(t.onkeypress=null,!0):(r=null,r=null!=n.key?32===n.charCode?" ":13===n.keyCode?"\n":n.key:String.fromCharCode(n.keyCode),r.length>0?(u=Math.min(t.selectionStart,t.selectionEnd),i=Math.abs(t.selectionEnd-t.selectionStart),e.deleteText(u,i),e.insertText(u,r),o=u+r.length,t.setSelectionRange(o,o),n.preventDefault()):n.preventDefault())},t.onpaste=function(n){return e.is_deleted?(t.onpaste=null,!0):n.preventDefault()},t.oncut=function(n){return e.is_deleted?(t.oncut=null,!0):n.preventDefault()},t.onkeydown=function(n){var r,i,o,u,s;if(e.is_deleted)return t.onkeydown=null,!0;if(u=Math.min(t.selectionStart,t.selectionEnd),i=Math.abs(t.selectionEnd-t.selectionStart),null!=n.keyCode&&8===n.keyCode){if(i>0)e.deleteText(u,i),t.setSelectionRange(u,u);else if(null!=n.ctrlKey&&n.ctrlKey){for(s=t.value,o=u,r=0,u>0&&(o--,r++);o>0&&" "!==s[o]&&"\n"!==s[o];)o--,r++;e.deleteText(o,u-o),t.setSelectionRange(o,o)}else e.deleteText(u-1,1);return n.preventDefault()}return null!=n.keyCode&&46===n.keyCode?(i>0?(e.deleteText(u,i),t.setSelectionRange(u,u)):(e.deleteText(u,1),t.setSelectionRange(u,u)),n.preventDefault()):void 0}},n.prototype._encode=function(){var t;return t={type:"WordType",uid:this.getUid()}},n}(l.ListManager),u.WordType=function(t){var e;return e=t.uid,new o(e)},l.TextInsert=r,l.TextDelete=e,l.WordType=o,s}},{"./StructuredTypes":6}],8:[function(t){var e,n;e=t("./yatta"),n=function(t){var e,n,r,i;for(n=r=0,i=t.children.length;i>=0?i>r:r>i;n=i>=0?++r:--r)e=t.children.item(n),null!=e.name&&(e.val=t.val.val(e.name));return t.val.observe(function(r){var i,o,u,s,l;for(l=[],u=0,s=r.length;s>u;u++)i=r[u],null!=i.name?l.push(function(){var r,u,s;for(s=[],n=r=0,u=t.children.length;u>=0?u>r:r>u;n=u>=0?++r:--r)e=t.children.item(n),null!=e.name&&e.name===i.name?(o=t.val.val(e.name),e.val!==o?s.push(e.val=o):s.push(void 0)):s.push(void 0);return s}()):l.push(void 0);return l})},Polymer("yatta-element",{ready:function(){return null!=this.connector?(this.val=new e(this.connector),n(this)):null!=this.val?n(this):void 0},valChanged:function(){return null!=this.val&&"JsonType"===this.val.type?n(this):void 0},connectorChanged:function(){return null==this.val?(this.val=new e(this.connector),n(this)):void 0}}),Polymer("yatta-property",{ready:function(){return null!=this.val&&null!=this.name&&(this.val.constructor===Object?this.val=this.parentElement.val(this.name,this.val).val(this.name):"string"==typeof this.val&&this.parentElement.val(this.name,this.val),"JsonType"===this.val.type)?n(this):void 0},valChanged:function(){var t;if(null!=this.val&&null!=this.name){if(this.val.constructor===Object)return this.val=this.parentElement.val.val(this.name,this.val).val(this.name);if("JsonType"===this.val.type)return n(this);if(null!=(null!=(t=this.parentElement.val)?t.val:void 0)&&this.val!==this.parentElement.val.val(this.name))return this.parentElement.val.val(this.name,this.val)}}})},{"./yatta":9}],9:[function(t,e){var n,r,i,o,u,s={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("./Types/JsonTypes"),r=t("./HistoryBuffer"),n=t("./Engine"),i=t("./ConnectorAdapter"),o=function(t){var e,o,s,p,a;return a=null,null!=t.id?a=t.id:(a="_temp",t.whenUserIdSet(function(t){return a=t,e.resetUserId(t)})),e=new r(a),s=u(e),p=s.types,o=function(r){function o(){this.connector=t,this.HB=e,this.types=p,this.engine=new n(this.HB,s.parser),i(this.connector,this.engine,this.HB,s.execution_listener),o.__super__.constructor.apply(this,arguments)}return l(o,r),o.prototype.getConnector=function(){return this.connector},o}(p.JsonType),new o(e.getReservedUniqueIdentifier()).execute()},e.exports=o,"undefined"!=typeof window&&null!==window&&null==window.Yatta&&(window.Yatta=o)},{"./ConnectorAdapter":1,"./Engine":2,"./HistoryBuffer":3,"./Types/JsonTypes":5}]},{},[8]);