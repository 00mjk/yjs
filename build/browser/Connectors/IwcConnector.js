(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var createIwcConnector;

createIwcConnector = function(callback, initial_user_id) {
  var IwcConnector, duiClient, init, iwcHandler, received_HB;
  iwcHandler = {};
  duiClient = new DUIClient();
  duiClient.connect(function(intent) {
    var _ref;
    return (_ref = iwcHandler[intent.action]) != null ? _ref.map(function(f) {
      return setTimeout(function() {
        return f(intent);
      }, 0);
    }) : void 0;
  });
  duiClient.initOK();
  received_HB = null;
  IwcConnector = (function() {
    function IwcConnector(engine, HB, execution_listener, yatta) {
      var receiveHB, receive_, sendHistoryBuffer, send_;
      this.engine = engine;
      this.HB = HB;
      this.execution_listener = execution_listener;
      this.yatta = yatta;
      this.duiClient = duiClient;
      this.iwcHandler = iwcHandler;
      send_ = (function(_this) {
        return function(o) {
          if (Object.getOwnPropertyNames(_this.initialized).length !== 0) {
            return _this.send(o);
          }
        };
      })(this);
      this.execution_listener.push(send_);
      this.initialized = {};
      receiveHB = (function(_this) {
        return function(json) {
          var him;
          HB = json.extras.HB;
          him = json.extras.user;
          _this.engine.applyOpsCheckDouble(HB);
          return _this.initialized[him] = true;
        };
      })(this);
      iwcHandler["Yatta_push_HB_element"] = [receiveHB];
      this.sendIwcIntent("Yatta_get_HB_element", {});
      receive_ = (function(_this) {
        return function(intent) {
          var o;
          o = intent.extras;
          if (_this.initialized[o.uid.creator] != null) {
            return _this.receive(o);
          }
        };
      })(this);
      this.iwcHandler["Yatta_new_operation"] = [receive_];
      if (received_HB != null) {
        this.engine.applyOpsCheckDouble(received_HB);
      }
      sendHistoryBuffer = (function(_this) {
        return function() {
          var json;
          json = {
            HB: _this.yatta.getHistoryBuffer()._encode(),
            user: _this.yatta.getUserId()
          };
          return _this.sendIwcIntent("Yatta_push_HB_element", json);
        };
      })(this);
      this.iwcHandler["Yatta_get_HB_element"] = [sendHistoryBuffer];
    }

    IwcConnector.prototype.send = function(o) {
      if (o.uid.creator === this.HB.getUserId() && (typeof o.uid.op_number !== "string")) {
        return this.sendIwcIntent("Yatta_new_operation", o);
      }
    };

    IwcConnector.prototype.receive = function(o) {
      if (o.uid.creator !== this.HB.getUserId()) {
        return this.engine.applyOp(o);
      }
    };

    IwcConnector.prototype.sendIwcIntent = function(action_name, content) {
      var intent;
      intent = {
        action: action_name,
        component: "",
        data: "",
        dataType: "",
        flags: ["PUBLISH_GLOBAL"],
        extras: content
      };
      return this.duiClient.sendIntent(intent);
    };

    return IwcConnector;

  })();
  init = function() {
    var proposed_user_id;
    proposed_user_id = null;
    if (initial_user_id != null) {
      proposed_user_id = initial_user_id;
    } else {
      proposed_user_id = Math.floor(Math.random() * 1000000);
    }
    return callback(IwcConnector, proposed_user_id);
  };
  setTimeout(init, 5000);
  return void 0;
};

module.exports = createIwcConnector;

if (typeof window !== "undefined" && window !== null) {
  if (window.Y == null) {
    window.Y = {};
  }
  window.Y.createIwcConnector = createIwcConnector;
}


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2Rtb25hZC9Ecm9wYm94L1lhdHRhIS9ub2RlX21vZHVsZXMvZ3VscC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvaG9tZS9kbW9uYWQvRHJvcGJveC9ZYXR0YSEvbGliL0Nvbm5lY3RvcnMvSXdjQ29ubmVjdG9yLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0tBLElBQUEsa0JBQUE7O0FBQUEsa0JBQUEsR0FBcUIsU0FBQyxRQUFELEVBQVcsZUFBWCxHQUFBO0FBQ25CLE1BQUEsc0RBQUE7QUFBQSxFQUFBLFVBQUEsR0FBYSxFQUFiLENBQUE7QUFBQSxFQUNBLFNBQUEsR0FBZ0IsSUFBQSxTQUFBLENBQUEsQ0FEaEIsQ0FBQTtBQUFBLEVBR0EsU0FBUyxDQUFDLE9BQVYsQ0FBa0IsU0FBQyxNQUFELEdBQUE7QUFDaEIsUUFBQSxJQUFBOzREQUF5QixDQUFFLEdBQTNCLENBQStCLFNBQUMsQ0FBRCxHQUFBO2FBQzdCLFVBQUEsQ0FBVyxTQUFBLEdBQUE7ZUFDVCxDQUFBLENBQUUsTUFBRixFQURTO01BQUEsQ0FBWCxFQUVFLENBRkYsRUFENkI7SUFBQSxDQUEvQixXQURnQjtFQUFBLENBQWxCLENBSEEsQ0FBQTtBQUFBLEVBU0EsU0FBUyxDQUFDLE1BQVYsQ0FBQSxDQVRBLENBQUE7QUFBQSxFQVdBLFdBQUEsR0FBYyxJQVhkLENBQUE7QUFBQSxFQWtCTTtBQVFTLElBQUEsc0JBQUUsTUFBRixFQUFXLEVBQVgsRUFBZ0Isa0JBQWhCLEVBQXFDLEtBQXJDLEdBQUE7QUFDWCxVQUFBLDZDQUFBO0FBQUEsTUFEWSxJQUFDLENBQUEsU0FBQSxNQUNiLENBQUE7QUFBQSxNQURxQixJQUFDLENBQUEsS0FBQSxFQUN0QixDQUFBO0FBQUEsTUFEMEIsSUFBQyxDQUFBLHFCQUFBLGtCQUMzQixDQUFBO0FBQUEsTUFEK0MsSUFBQyxDQUFBLFFB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dUIsZ0JBQXZCLEVBUEs7RUFBQSxDQWhHUCxDQUFBO0FBQUEsRUF5R0EsVUFBQSxDQUFXLElBQVgsRUFBaUIsSUFBakIsQ0F6R0EsQ0FBQTtTQTJHQSxPQTVHbUI7QUFBQSxDQUFyQixDQUFBOztBQUFBLE1BK0dNLENBQUMsT0FBUCxHQUFpQixrQkEvR2pCLENBQUE7O0FBZ0hBLElBQUcsZ0RBQUg7QUFDRSxFQUFBLElBQU8sZ0JBQVA7QUFDRSxJQUFBLE1BQU0sQ0FBQyxDQUFQLEdBQVcsRUFBWCxDQURGO0dBQUE7QUFBQSxFQUVBLE1BQU0sQ0FBQyxDQUFDLENBQUMsa0JBQVQsR0FBOEIsa0JBRjlCLENBREY7Q0FoSEEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXG4jXG4jIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBjYWxsYmFjayBpcyBjYWxsZWQgd2hlbiB0aGUgY29ubmVjdG9yIGlzIGluaXRpYWxpemVkLlxuIyBAcGFyYW0ge1N0cmluZ30gaW5pdGlhbF91c2VyX2lkIE9wdGlvbmFsLiBZb3UgY2FuIHNldCB5b3Ugb3duIHVzZXJfaWQgKHNpbmNlIHRoZSBpZHMgb2YgZHVpY2xpZW50IGFyZSBub3QgYWx3YXlzIHVuaXF1ZSlcbiNcbmNyZWF0ZUl3Y0Nvbm5lY3RvciA9IChjYWxsYmFjaywgaW5pdGlhbF91c2VyX2lkKS0+XG4gIGl3Y0hhbmRsZXIgPSB7fVxuICBkdWlDbGllbnQgPSBuZXcgRFVJQ2xpZW50KClcbiAgI0BkdWlDbGllbnQgPSBuZXcgaXdjLkNsaWVudCgpXG4gIGR1aUNsaWVudC5jb25uZWN0IChpbnRlbnQpLT5cbiAgICBpd2NIYW5kbGVyW2ludGVudC5hY3Rpb25dPy5tYXAgKGYpLT5cbiAgICAgIHNldFRpbWVvdXQgKCktPlxuICAgICAgICBmIGludGVudFxuICAgICAgLCAwXG5cbiAgZHVpQ2xpZW50LmluaXRPSygpXG5cbiAgcmVjZWl2ZWRfSEIgPSBudWxsXG5cbiAgI1xuICAjIFRoZSBJd2MgQ29ubmVjdG9yIGFkZHMgc3VwcG9ydCBmb3IgdGhlIEludGVyLVdpZGdldC1Db21tdW5pY2F0aW9uIHByb3RvY29sIHRoYXQgaXMgdXNlZCBpbiB0aGUgUm9sZS1TREsuXG4gICMgQHNlZSBodHRwOi8vZGJpcy5yd3RoLWFhY2hlbi5kZS9jbXMvcHJvamVjdHMvdGhlLXhtcHAtZXhwZXJpZW5jZSNpbnRlcndpZGdldC1jb21tdW5pY2F0aW9uXG4gICMgQHNlZSBodHRwOi8vZGJpcy5yd3RoLWFhY2hlbi5kZS9jbXMvcHJvamVjdHMvUk9MRVxuICAjXG4gIGNsYXNzIEl3Y0Nvbm5lY3RvclxuXG4gICAgI1xuICAgICMgQHBhcmFtIHtFbmdpbmV9IGVuZ2luZSBUaGUgdHJhbnNmb3JtYXRpb24gZW5naW5lXG4gICAgIyBAcGFyYW0ge0hpc3RvcnlCdWZmZXJ9IEhCXG4gICAgIyBAcGFyYW0ge0FycmF5PEZ1bmN0aW9uPn0gZXhlY3V0aW9uX2xpc3RlbmVyIFlvdSBtdXN0IGVuc3VyZSB0aGF0IHdoZW5ldmVyIGFuIG9wZXJhdGlvbiBpcyBleGVjdXRlZCwgZXZlcnkgZnVuY3Rpb24gaW4gdGhpcyBBcnJheSBpcyBjYWxsZWQuXG4gICAgIyBAcGFyYW0ge1lhdHRhfSB5YXR0YSBUaGUgWWF0dGEgZnJhbWV3b3JrLlxuICAgICNcbiAgICBjb25zdHJ1Y3RvcjogKEBlbmdpbmUsIEBIQiwgQGV4ZWN1dGlvbl9saXN0ZW5lciwgQHlhdHRhKS0+XG4gICAgICBAZHVpQ2xpZW50ID0gZHVpQ2xpZW50XG4gICAgICBAaXdjSGFuZGxlciA9IGl3Y0hhbmRsZXJcblxuICAgICAgc2VuZF8gPSAobyk9PlxuICAgICAgICBpZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhAaW5pdGlhbGl6ZWQpLmxlbmd0aCBpc250IDBcbiAgICAgICAgICBAc2VuZCBvXG4gICAgICBAZXhlY3V0aW9uX2xpc3RlbmVyLnB1c2ggc2VuZF9cblxuICAgICAgQGluaXRpYWxpemVkID0ge31cbiAgICAgIHJlY2VpdmVIQiA9IChqc29uKT0+XG4gICAgICAgIEhCID0ganNvbi5leHRyYXMuSEJcbiAgICAgICAgaGltID0ganNvbi5leHRyYXMudXNlclxuICAgICAgICB0aGlzLmVuZ2luZS5hcHBseU9wc0NoZWNrRG91YmxlIEhCXG4gICAgICAgIEBpbml0aWFsaXplZFtoaW1dID0gdHJ1ZVxuICAgICAgaXdjSGFuZGxlcltcIllhdHRhX3B1c2hfSEJfZWxlbWVudFwiXSA9IFtyZWNlaXZlSEJdXG5cbiAgICAgIEBzZW5kSXdjSW50ZW50IFwiWWF0dGFfZ2V0X0hCX2VsZW1lbnRcIiwge31cblxuICAgICAgcmVjZWl2ZV8gPSAoaW50ZW50KT0+XG4gICAgICAgIG8gPSBpbnRlbnQuZXh0cmFzXG4gICAgICAgIGlmIEBpbml0aWFsaXplZFtvLnVpZC5jcmVhdG9yXT8gIyBpbml0aWFsaXplIGZpcnN0XG4gICAgICAgICAgQHJlY2VpdmUgb1xuXG4gICAgICBAaXdjSGFuZGxlcltcIllhdHRhX25ld19vcGVyYXRpb25cIl0gPSBbcmVjZWl2ZV9dXG5cbiAgICAgIGlmIHJlY2VpdmVkX0hCP1xuICAgICAgICBAZW5naW5lLmFwcGx5T3BzQ2hlY2tEb3VibGUgcmVjZWl2ZWRfSEJcblxuICAgICAgc2VuZEhpc3RvcnlCdWZmZXIgPSAoKT0+XG4gICAgICAgIGpzb24gPVxuICAgICAgICAgIEhCIDogQHlhdHRhLmdldEhpc3RvcnlCdWZmZXIoKS5fZW5jb2RlKClcbiAgICAgICAgICB1c2VyIDogQHlhdHRhLmdldFVzZXJJZCgpXG4gICAgICAgIEBzZW5kSXdjSW50ZW50IFwiWWF0dGFfcHVzaF9IQl9lbGVtZW50XCIsIGpzb25cbiAgICAgIEBpd2NIYW5kbGVyW1wiWWF0dGFfZ2V0X0hCX2VsZW1lbnRcIl0gPSBbc2VuZEhpc3RvcnlCdWZmZXJdXG5cbiAgICAjXG4gICAgIyBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuZXZlciBhbiBvcGVyYXRpb24gd2FzIGV4ZWN1dGVkLlxuICAgICMgQHBhcmFtIHtPcGVyYXRpb259IG8gVGhlIG9wZXJhdGlvbiB0aGF0IHdhcyBleGVjdXRlZC5cbiAgICAjXG4gICAgc2VuZDogKG8pLT5cbiAgICAgIGlmIG8udWlkLmNyZWF0b3IgaXMgQEhCLmdldFVzZXJJZCgpIGFuZCAodHlwZW9mIG8udWlkLm9wX251bWJlciBpc250IFwic3RyaW5nXCIpXG4gICAgICAgIEBzZW5kSXdjSW50ZW50IFwiWWF0dGFfbmV3X29wZXJhdGlvblwiLCBvXG5cbiAgICAjXG4gICAgIyBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuZXZlciBhbiBvcGVyYXRpb24gd2FzIHJlY2VpdmVkIGZyb20gYW5vdGhlciBwZWVyLlxuICAgICMgQHBhcmFtIHtPcGVyYXRpb259IG8gVGhlIG9wZXJhdGlvbiB0aGF0IHdhcyByZWNlaXZlZC5cbiAgICAjXG4gICAgcmVjZWl2ZTogKG8pLT5cbiAgICAgIGlmIG8udWlkLmNyZWF0b3IgaXNudCBASEIuZ2V0VXNlcklkKClcbiAgICAgICAgQGVuZ2luZS5hcHBseU9wIG9cblxuICAgICNcbiAgICAjIEhlbHBlciBmb3Igc2VuZGluZyBpd2MgaW50ZW50cy5cbiAgICAjIEBwYXJhbSB7U3RyaW5nfSBhY3Rpb25fbmFtZSBUaGUgbmFtZSBvZiB0aGUgYWN0aW9uIHRoYXQgaXMgZ29pbmcgdG8gYmUgc2VuZC5cbiAgICAjIEBwYXJhbSB7U3RyaW5nfSBjb250ZW50IFRoZSBjb250ZW50IHRoYXQgaXMgYXR0ZWNoZWQgdG8gdGhlIGludGVudC5cbiAgICAjXG4gICAgc2VuZEl3Y0ludGVudDogKGFjdGlvbl9uYW1lLCBjb250ZW50KS0+XG4gICAgICBpbnRlbnQgPVxuICAgICAgICBhY3Rpb246IGFjdGlvbl9uYW1lXG4gICAgICAgIGNvbXBvbmVudDogXCJcIlxuICAgICAgICBkYXRhOiBcIlwiXG4gICAgICAgIGRhdGFUeXBlOiBcIlwiXG4gICAgICAgIGZsYWdzOiBbXCJQVUJMSVNIX0dMT0JBTFwiXVxuICAgICAgICBleHRyYXM6IGNvbnRlbnRcblxuICAgICAgQGR1aUNsaWVudC5zZW5kSW50ZW50KGludGVudClcblxuXG5cbiAgaW5pdCA9ICgpLT5cbiAgICBwcm9wb3NlZF91c2VyX2lkID0gbnVsbFxuICAgIGlmIGluaXRpYWxfdXNlcl9pZD9cbiAgICAgIHByb3Bvc2VkX3VzZXJfaWQgPSBpbml0aWFsX3VzZXJfaWRcbiAgICBlbHNlXG4gICAgICAjIHByb3Bvc2VkX3VzZXJfaWQgPSBkdWlDbGllbnQuZ2V0SXdjQ2xpZW50KCkuX2NvbXBvbmVudE5hbWUgI1RPRE86IFRoaXMgaXMgc3R1cGlkISB3aHkgY2FuJ3QgaSB1c2UgdGhpcz9cbiAgICAgIHByb3Bvc2VkX3VzZXJfaWQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMTAwMDAwMClcbiAgICBjYWxsYmFjayBJd2NDb25uZWN0b3IsIHByb3Bvc2VkX3VzZXJfaWRcblxuICBzZXRUaW1lb3V0IGluaXQsIDUwMDBcblxuICB1bmRlZmluZWRcblxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUl3Y0Nvbm5lY3RvclxuaWYgd2luZG93P1xuICBpZiBub3Qgd2luZG93Llk/XG4gICAgd2luZG93LlkgPSB7fVxuICB3aW5kb3cuWS5jcmVhdGVJd2NDb25uZWN0b3IgPSBjcmVhdGVJd2NDb25uZWN0b3JcblxuIl19
